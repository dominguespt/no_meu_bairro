<div class="container">
  <div class="row justify-content-center">
    <div class="col-sm-16 col-lg-6">
      <div class="mt-3">
        <h1><%= @service.name %></h1>
      </div>
      <% if @service.photo.attached?%>
        <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <%= cl_image_tag @service.photo.key, crop: :fill, class: "d-block w-100", alt: "First slide" %>
            </div>
            <div class="carousel-item">
              <%= cl_image_tag @service.photo.key, crop: :fill, class: "d-block w-100", alt: "Second slide" %>
            </div>
            <div class="carousel-item">
              <%= cl_image_tag @service.photo.key, crop: :fill, class: "d-block w-100", alt: "Third slide" %>
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      <% end %>
      <div class="mt-2">
        <p ><strong><i class="fas fa-map-marker-alt mr-2"></i> <%= @service.address %></strong></p>
        <p style="color: #F6830F"><strong><%= @service.category %></strong></p>
        <p class="mt-5"><%= @service.description %></p>
      </div>
      <div>
        <% if current_user == @service.user %>
          <%= link_to edit_neighbourhood_service_path(@neighbourhood, @service) do %>

          <button id="sweet-alert-demo" class="btn btn-danger m-3">Delete <%= @service.name %></button>
            <%= link_to "", edit_neighbourhood_service_path(@neighbourhood, @service), method: :delete, id: "delete-link", class: "hidden" %>

            <p>Edit Service</p>
          <% end %>
          <%= link_to "Delete service",
                      neighbourhood_service_path(@service),
                      method: :delete,
                      data: { confirm: "Are you sure?" } %>
        <% end  %>
      </div>
      <div class="mt-4">
        <% if current_user != @service.user %>
          <%= render 'reviews/new' %>
        <% end %>
      </div>
      <div class="mt-4">
        <%= render 'reviews/show' %>
      </div>
      <div class="mt-4 center-buttons">
        <%= link_to neighbourhood_path(@neighbourhood) do %>
          <i class="fas fa-arrow-left m-5" style="font-size: 30px"></i>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div id="map"
    style="width: 100%; height: 600px;"
    data-markers="<%= @markers.to_json %>"
    data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
</div>

<%= render 'components/footer' %>

<script>
  function reloadPage() {
  // The last "domLoading" Time //
  var currentDocumentTimestamp =
  new Date(performance.timing.domLoading).getTime();
  // Current Time //
  var now = Date.now();
  // Ten Seconds //
  var tenSec = 1000;
  // Plus Ten Seconds //
  var plusTenSec = currentDocumentTimestamp + tenSec;
  if (now > plusTenSec) {
  location.reload();
  } else {}
  }
  reloadPage();
</script>
